# ========================================
# SCHOOL MANAGEMENT SYSTEM - PRODUCTION ENVIRONMENT
# ========================================
# Copy this file to .env and fill in your production values
# CRITICAL: Never commit .env file to version control
# ========================================

# ========================================
# DJANGO CORE SETTINGS
# ========================================
SECRET_KEY=your-super-secret-key-change-this-in-production-min-50-chars
DEBUG=False
ALLOWED_HOSTS=yourdomain.com,www.yourdomain.com,api.yourdomain.com

# Environment
ENVIRONMENT=production

# ========================================
# DATABASE CONFIGURATION (PostgreSQL)
# ========================================
# Multi-tenant schema-per-tenant setup
DB_ENGINE=django.db.backends.postgresql
DB_NAME=schoolmgmt_prod
DB_USER=schoolmgmt_user
DB_PASSWORD=your-strong-database-password-here
DB_HOST=your-rds-endpoint.region.rds.amazonaws.com
DB_PORT=5432

# Connection pooling
DB_CONN_MAX_AGE=600

# ========================================
# EMAIL CONFIGURATION
# ========================================
# Choose ONE provider: Gmail, SendGrid, or AWS SES

# --- OPTION 1: Gmail (For testing/small deployments) ---
# EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
# EMAIL_HOST=smtp.gmail.com
# EMAIL_PORT=587
# EMAIL_USE_TLS=True
# EMAIL_HOST_USER=your-email@gmail.com
# EMAIL_HOST_PASSWORD=your-app-specific-password
# DEFAULT_FROM_EMAIL=School Management System <your-email@gmail.com>

# --- OPTION 2: SendGrid (Recommended for production) ---
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=smtp.sendgrid.net
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=apikey
EMAIL_HOST_PASSWORD=SG.your-sendgrid-api-key-here
DEFAULT_FROM_EMAIL=School Management System <noreply@yourdomain.com>

# --- OPTION 3: AWS SES (Best for AWS deployments) ---
# EMAIL_BACKEND=django_ses.SESBackend
# AWS_SES_REGION_NAME=us-east-1
# AWS_SES_REGION_ENDPOINT=email.us-east-1.amazonaws.com
# AWS_ACCESS_KEY_ID=your-aws-access-key-id
# AWS_SECRET_ACCESS_KEY=your-aws-secret-access-key
# DEFAULT_FROM_EMAIL=School Management System <noreply@yourdomain.com>

# ========================================
# SMS CONFIGURATION (Twilio)
# ========================================
# For OTP verification in parental consent
SMS_PROVIDER=twilio
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=your-twilio-auth-token-here
TWILIO_PHONE_NUMBER=+1234567890

# Alternative: MSG91 (Popular in India)
# SMS_PROVIDER=msg91
# MSG91_AUTH_KEY=your-msg91-auth-key
# MSG91_SENDER_ID=SCHLMS
# MSG91_ROUTE=4

# ========================================
# REDIS CONFIGURATION
# ========================================
# For caching and Celery broker
REDIS_URL=redis://your-redis-endpoint:6379/0
CELERY_BROKER_URL=redis://your-redis-endpoint:6379/0
CELERY_RESULT_BACKEND=redis://your-redis-endpoint:6379/0

# ========================================
# AWS S3 CONFIGURATION
# ========================================
# For static files and media storage
USE_S3=True
AWS_ACCESS_KEY_ID=your-aws-access-key-id
AWS_SECRET_ACCESS_KEY=your-aws-secret-access-key
AWS_STORAGE_BUCKET_NAME=schoolmgmt-prod-media
AWS_S3_REGION_NAME=us-east-1
AWS_S3_CUSTOM_DOMAIN=cdn.yourdomain.com

# CloudFront CDN (optional but recommended)
AWS_S3_CLOUDFRONT_DOMAIN=d1234567890abc.cloudfront.net

# ========================================
# ENCRYPTION KEYS (DPDP Act Compliance)
# ========================================
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# CRITICAL: Store these securely, backup in AWS KMS or HashiCorp Vault

# Primary encryption key (for sensitive fields)
FERNET_PRIMARY_KEY=your-primary-fernet-key-44-chars-base64-encoded

# Secondary encryption key (for key rotation)
FERNET_SECONDARY_KEY=your-secondary-fernet-key-44-chars-base64-encoded

# AWS KMS integration (recommended for production)
USE_AWS_KMS=True
AWS_KMS_KEY_ID=arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012

# ========================================
# PAYMENT GATEWAY CONFIGURATION
# ========================================
# Razorpay (Popular in India)
RAZORPAY_KEY_ID=rzp_live_xxxxxxxxxx
RAZORPAY_KEY_SECRET=your-razorpay-secret-key

# PayU (Alternative)
PAYU_MERCHANT_KEY=your-payu-merchant-key
PAYU_MERCHANT_SALT=your-payu-merchant-salt
PAYU_MODE=LIVE

# ========================================
# MONITORING & LOGGING
# ========================================
# Sentry (Error tracking)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# New Relic (APM)
NEW_RELIC_LICENSE_KEY=your-new-relic-license-key
NEW_RELIC_APP_NAME=School Management System Production

# ========================================
# SECURITY SETTINGS
# ========================================
# SSL/TLS
SECURE_SSL_REDIRECT=True
SESSION_COOKIE_SECURE=True
CSRF_COOKIE_SECURE=True
SECURE_HSTS_SECONDS=31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS=True
SECURE_HSTS_PRELOAD=True

# CORS (for frontend)
CORS_ALLOWED_ORIGINS=https://yourdomain.com,https://www.yourdomain.com
CORS_ALLOW_CREDENTIALS=True

# ========================================
# DPDP ACT 2023 COMPLIANCE SETTINGS
# ========================================
# Data Protection Officer (DPO) contact
DPO_NAME=Your DPO Name
DPO_EMAIL=dpo@yourdomain.com
DPO_PHONE=+91-1234567890

# Data retention periods (days)
CONSENT_RETENTION_DAYS=2555  # 7 years
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years
FINANCIAL_RECORDS_RETENTION_DAYS=2555  # 7 years (tax requirement)
ACADEMIC_RECORDS_RETENTION_DAYS=1825  # 5 years
HEALTH_DATA_RETENTION_DAYS=1825  # 5 years

# Grievance SLA (hours)
GRIEVANCE_ACKNOWLEDGMENT_SLA_HOURS=24
GRIEVANCE_RESOLUTION_SLA_HOURS=72

# Data breach notification
DATA_BREACH_NOTIFICATION_ENABLED=True
DATA_BREACH_DPB_EMAIL=grievances@dataprotection.gov.in

# ========================================
# CELERY CONFIGURATION
# ========================================
# For background tasks (email sending, report generation, etc.)
CELERY_BROKER_URL=redis://your-redis-endpoint:6379/0
CELERY_RESULT_BACKEND=redis://your-redis-endpoint:6379/0
CELERY_ACCEPT_CONTENT=json
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_TIMEZONE=Asia/Kolkata

# ========================================
# FRONTEND CONFIGURATION
# ========================================
FRONTEND_URL=https://yourdomain.com
API_URL=https://api.yourdomain.com

# ========================================
# BACKUP CONFIGURATION
# ========================================
# Automated backups to S3
BACKUP_ENABLED=True
BACKUP_S3_BUCKET=schoolmgmt-prod-backups
BACKUP_SCHEDULE_CRON=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30

# ========================================
# PERFORMANCE SETTINGS
# ========================================
# Database connection pooling
DB_CONN_MAX_AGE=600

# Cache timeout (seconds)
CACHE_TTL=3600

# Static file caching (seconds)
STATIC_FILE_MAX_AGE=31536000  # 1 year

# ========================================
# FEATURE FLAGS
# ========================================
# Enable/disable features
ENABLE_PARENT_PORTAL=True
ENABLE_TEACHER_PORTAL=True
ENABLE_STUDENT_PORTAL=True
ENABLE_TRANSPORT_MODULE=True
ENABLE_LIBRARY_MODULE=True
ENABLE_HOSTEL_MODULE=False
ENABLE_EXAM_MODULE=True
ENABLE_FINANCE_MODULE=True

# DPDP Compliance features
ENABLE_CONSENT_MANAGEMENT=True
ENABLE_AUDIT_LOGGING=True
ENABLE_GRIEVANCE_SYSTEM=True
ENABLE_DATA_EXPORT=True
ENABLE_DATA_DELETION=True

# ========================================
# LOCALE & TIMEZONE
# ========================================
TIME_ZONE=Asia/Kolkata
LANGUAGE_CODE=en-us
USE_I18N=True
USE_L10N=True
USE_TZ=True

# ========================================
# LOGGING CONFIGURATION
# ========================================
LOG_LEVEL=INFO
LOG_FILE=/var/log/schoolmgmt/django.log
LOG_MAX_BYTES=10485760  # 10 MB
LOG_BACKUP_COUNT=10

# ========================================
# RATE LIMITING
# ========================================
# Prevent abuse
RATE_LIMIT_ENABLED=True
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000

# OTP rate limiting
OTP_MAX_ATTEMPTS_PER_HOUR=5
OTP_BLOCK_DURATION_MINUTES=60

# ========================================
# TESTING & DEBUG (Set to False in production)
# ========================================
ENABLE_API_DOCS=False
ENABLE_DEBUG_TOOLBAR=False
ENABLE_SILK_PROFILER=False

# ========================================
# END OF CONFIGURATION
# ========================================

# IMPORTANT NOTES:
# 1. Generate a new SECRET_KEY for production
# 2. Set DEBUG=False in production
# 3. Configure your domain in ALLOWED_HOSTS
# 4. Setup SSL/TLS certificates
# 5. Configure email/SMS gateways
# 6. Generate new Fernet encryption keys
# 7. Setup monitoring (Sentry, New Relic)
# 8. Configure automated backups
# 9. Sign Data Processing Agreements (DPAs) with all third-party vendors
# 10. Complete penetration testing before go-live
